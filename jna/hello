#!/usr/bin/env groovy

// https://mvnrepository.com/artifact/net.java.dev.jna/jna
@Grapes(
    @Grab(group='net.java.dev.jna', module='jna', version='4.2.2')
)

import com.sun.jna.NativeLibrary
import com.sun.jna.Platform

public class CLib {
    static def lib = NativeLibrary.getInstance(Platform.isWindows() ? 'msvcrt' : 'c')
    static def printf(format, args) {
        lib.getFunction('printf').invokeVoid([format, args])
    }
}

CLib.printf("Hello, World\n")
for(int i = 0; i < args.length; i++) {
    CLib.printf('Argument %d: %s\n', i, args[i])
}
